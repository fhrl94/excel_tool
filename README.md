# Excel-
Excel批量解密工具与密码管理

一、核心功能需求
1. 批量加密功能
为多个Excel文件设置密码

支持从密码本（CSV格式）匹配密码

支持统一密码设置

保持原文件不变，生成加密后的新文件

2. 批量解密功能
移除Excel文件的密码保护

支持从密码本（CSV格式）匹配密码

支持无密码解密（针对无密码文件）

保持原文件不变，生成解密后的新文件

3. 文件安全保护
不修改原文件：所有处理都在新文件中进行

输入输出分离：明确区分输入文件夹和输出文件夹

文件名后缀：可自定义后缀（如"_加密"、"_解密"）

文件备份：避免因程序问题损坏原文件

二、密码管理需求
1. 密码本支持
CSV格式：第一列文件名，第二列密码

自动编码检测（支持UTF-8、GBK等）

自动匹配文件名和密码

支持注释行（以#开头）

2. 密码编辑功能
自动匹配后可以手动修改密码

批量更新选中文件的密码

统一密码设置

处理完成后密码不可编辑

3. 密码显示控制
密码显示/隐藏切换

表格中密码列可编辑

状态管理（待处理/已处理）

三、界面需求
1. 文件夹设置
输入文件夹：选择要处理的文件

输出文件夹：保存处理后的文件

"使用相同文件夹"选项

自动创建不存在的输出文件夹

2. 文件列表
显示文件夹中所有Excel文件

文件选择（全选/反选）

状态显示（待处理/成功/失败）

密码和备注显示

新文件名预览

3. 进度和日志
实时进度条显示

详细的操作日志

颜色区分（成功/失败/警告/信息）

日志导出功能

四、处理流程需求
1. 完整处理流程
text
选择文件夹 → 扫描文件 → 设置密码 → 预览 → 开始处理 → 查看结果
2. 静默处理要求
Excel完全后台运行

不显示任何密码输入对话框

不弹出任何警告窗口

用户看不到Excel界面

3. 错误处理
文件不存在检查

密码错误提示

权限问题处理

异常情况捕获

五、技术实现需求
1. 体积优化
使用csv模块替代pandas，减小打包体积

排除不必要的依赖库

优化打包配置

2. 性能要求
多文件批量处理

进度实时反馈

支持取消操作

线程安全处理

3. 兼容性
支持.xlsx和.xls格式

支持多种Excel版本

Windows系统兼容

六、特殊注意事项
1. 路径问题解决
确保文件保存到指定位置，而不是"我的文档"

使用绝对路径避免相对路径问题

提前检查输出文件夹权限

2. 密码处理
加密时设置读写密码

解密时移除所有保护（密码、结构保护、工作表保护）

正确处理密码错误情况

3. 用户交互
友好的错误提示

处理前的确认对话框

处理完成后的结果汇总

详细的失败原因说明

七、打包部署需求
1. EXE文件生成
单个可执行文件

不依赖Python环境

较小的文件体积

支持快速启动

2. 使用便利性
双击即可运行

界面直观易用

完整的操作指引

错误提示明确

八、扩展功能（可选）
1. 模板功能
密码本模板导出

配置保存和加载

常用设置记忆

2. 批量操作
按规则批量生成密码

文件名批量重命名

处理结果统计报告

3. 高级功能
密码强度检查

处理历史记录

多线程加速处理
